# Task 16 - MOYENNE : Champs AI dans useSupplierInvoices

## Fichiers a modifier
- `src/hooks/useSupplierInvoices.js` (lignes 56-81)

## Probleme
Le hook `createInvoice` n'insere que les champs de base. Les nouvelles colonnes AI (total_ht, total_ttc, currency, etc.) ne sont pas gerees. Aucune methode n'existe pour inserer les line items.

## Solution
1. Le `createInvoice` passe deja `...invoiceData` dans l'insert (ligne 66), donc les champs supplementaires seront automatiquement inclus si presents dans invoiceData. Pas de modification necessaire pour l'insert.
2. Ajouter une nouvelle methode `createLineItems(invoiceId, items)` pour inserer les lignes de facture.

## Code attendu (ajouter APRES la methode updateStatus, avant le useEffect ligne 112)

```javascript
  const createLineItems = async (invoiceId, items) => {
    if (!items || items.length === 0) return;
    try {
      const lineItems = items.map((item, index) => ({
        invoice_id: invoiceId,
        description: item.description || '',
        quantity: item.quantity || 1,
        unit_price: item.unit_price || 0,
        total: item.total || 0,
        sort_order: index,
      }));

      const { error } = await supabase
        .from('supplier_invoice_line_items')
        .insert(lineItems);

      if (error) throw error;
    } catch (err) {
      console.error('Error creating line items:', err);
    }
  };
```

Et modifier le return (ligne 116-123) pour exporter createLineItems :

```javascript
  return {
    invoices,
    loading,
    fetchInvoices,
    createInvoice,
    createLineItems,
    deleteInvoice,
    updateStatus
  };
```

## Criteres de verification
- [ ] Methode createLineItems presente
- [ ] Insert dans supplier_invoice_line_items
- [ ] createLineItems exporte dans le return
- [ ] Mapping correct des champs (description, quantity, unit_price, total, sort_order)

## Statut
- [ ] Complete
